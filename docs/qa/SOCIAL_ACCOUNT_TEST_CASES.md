# 소셜 계정 연동 QA 테스트케이스

## 개요

- **기능**: GitHub/Google OAuth 소셜 로그인 및 계정 연동
- **테스트 환경**: 개발/스테이징 서버
- **사전 조건**: OAuth 앱 설정 완료 (GitHub, Google)

---

## TC-001: GitHub OAuth 신규 회원가입

| 항목 | 내용 |
|------|------|
| **ID** | TC-001 |
| **우선순위** | Critical |
| **사전조건** | 로그아웃 상태, GitHub 계정 보유 |

### 테스트 단계

1. 로그인 페이지 접속
2. "GitHub로 로그인" 버튼 클릭
3. GitHub 인증 페이지로 리다이렉트 확인
4. GitHub 계정으로 인증 (앱 권한 승인)
5. 서비스로 콜백 리다이렉트

### 예상 결과

- [ ] 신규 사용자 계정 생성됨
- [ ] `social_accounts` 테이블에 GitHub 연동 정보 저장됨
- [ ] 로그인 완료 후 대시보드/홈으로 이동
- [ ] 사용자 이름: GitHub 프로필 name 사용
- [ ] 사용자 이메일: GitHub primary email 사용

---

## TC-002: GitHub OAuth 기존 회원 로그인

| 항목 | 내용 |
|------|------|
| **ID** | TC-002 |
| **우선순위** | Critical |
| **사전조건** | 로그아웃 상태, 이미 GitHub 연동된 계정 존재 |

### 테스트 단계

1. 로그인 페이지 접속
2. "GitHub로 로그인" 버튼 클릭
3. GitHub 인증 완료

### 예상 결과

- [ ] 기존 계정으로 로그인됨 (새 계정 생성되지 않음)
- [ ] `social_accounts.access_token` 갱신됨
- [ ] 로그인 완료 후 대시보드/홈으로 이동

---

## TC-003: GitHub OAuth 이메일 매칭 연동

| 항목 | 내용 |
|------|------|
| **ID** | TC-003 |
| **우선순위** | High |
| **사전조건** | 이메일/비밀번호로 가입한 계정 존재, 동일 이메일의 GitHub 계정 |

### 테스트 단계

1. 로그아웃 상태에서 "GitHub로 로그인" 클릭
2. 동일 이메일의 GitHub 계정으로 인증

### 예상 결과

- [ ] 기존 계정에 GitHub 소셜 계정 연동됨
- [ ] 새 계정 생성되지 않음
- [ ] 설정 페이지에서 GitHub 연동 상태 표시됨

---

## TC-004: Google OAuth 신규 회원가입

| 항목 | 내용 |
|------|------|
| **ID** | TC-004 |
| **우선순위** | Critical |
| **사전조건** | 로그아웃 상태, Google 계정 보유 |

### 테스트 단계

1. 로그인 페이지 접속
2. "Google로 로그인" 버튼 클릭
3. Google 계정 선택 및 인증
4. 서비스로 콜백 리다이렉트

### 예상 결과

- [ ] 신규 사용자 계정 생성됨
- [ ] `social_accounts` 테이블에 Google 연동 정보 저장됨
- [ ] 로그인 완료
- [ ] 사용자 이름: Google 프로필 name 사용

---

## TC-005: Google OAuth 기존 회원 로그인

| 항목 | 내용 |
|------|------|
| **ID** | TC-005 |
| **우선순위** | Critical |
| **사전조건** | 이미 Google 연동된 계정 존재 |

### 테스트 단계

1. 로그인 페이지 접속
2. "Google로 로그인" 버튼 클릭
3. Google 인증 완료

### 예상 결과

- [ ] 기존 계정으로 로그인됨
- [ ] 토큰 갱신됨

---

## TC-006: 설정 페이지 소셜 계정 목록 조회

| 항목 | 내용 |
|------|------|
| **ID** | TC-006 |
| **우선순위** | High |
| **사전조건** | 로그인 상태, GitHub 연동 완료 |

### 테스트 단계

1. 설정 페이지 > 계정 탭 접속
2. "소셜 계정 연동" 섹션 확인

### 예상 결과

- [ ] GitHub: "연동됨" 상태 표시
- [ ] Google: "연동하기" 버튼 표시
- [ ] 연동된 계정에 "연동 해제" 버튼 표시

---

## TC-007: 설정 페이지에서 소셜 계정 추가 연동

| 항목 | 내용 |
|------|------|
| **ID** | TC-007 |
| **우선순위** | High |
| **사전조건** | 로그인 상태, Google 미연동 |

### 테스트 단계

1. 설정 페이지 > 계정 탭 접속
2. Google "연동하기" 버튼 클릭
3. Google 인증 완료

### 예상 결과

- [ ] Google 계정 연동됨
- [ ] 설정 페이지에서 Google "연동됨" 상태로 변경
- [ ] 성공 메시지 표시

---

## TC-008: 소셜 계정 연동 해제 (비밀번호 있음)

| 항목 | 내용 |
|------|------|
| **ID** | TC-008 |
| **우선순위** | High |
| **사전조건** | 로그인 상태, 비밀번호 설정됨, GitHub 연동됨 |

### 테스트 단계

1. 설정 페이지 > 계정 탭 접속
2. GitHub "연동 해제" 버튼 클릭
3. 확인 모달에서 "해제" 클릭

### 예상 결과

- [ ] GitHub 연동 해제됨
- [ ] 설정 페이지에서 GitHub "연동하기" 버튼으로 변경
- [ ] `social_accounts` 테이블에서 soft delete 처리됨
- [ ] 성공 메시지 표시

---

## TC-009: 소셜 계정 연동 해제 (복수 소셜 계정)

| 항목 | 내용 |
|------|------|
| **ID** | TC-009 |
| **우선순위** | High |
| **사전조건** | 비밀번호 없음, GitHub + Google 연동됨 |

### 테스트 단계

1. 설정 페이지 > 계정 탭 접속
2. GitHub "연동 해제" 버튼 클릭
3. 확인 모달에서 "해제" 클릭

### 예상 결과

- [ ] GitHub 연동 해제됨
- [ ] Google 연동은 유지됨
- [ ] 계정 로그인 가능 (Google로)

---

## TC-010: 마지막 인증 수단 연동 해제 차단

| 항목 | 내용 |
|------|------|
| **ID** | TC-010 |
| **우선순위** | Critical |
| **사전조건** | 비밀번호 없음, GitHub만 연동됨 (유일한 인증 수단) |

### 테스트 단계

1. 설정 페이지 > 계정 탭 접속
2. GitHub "연동 해제" 버튼 상태 확인

### 예상 결과

- [ ] "연동 해제" 버튼 비활성화 또는 숨김
- [ ] "마지막 인증 수단입니다" 경고 메시지 표시
- [ ] 연동 해제 불가

---

## TC-011: OAuth 인증 취소

| 항목 | 내용 |
|------|------|
| **ID** | TC-011 |
| **우선순위** | Medium |
| **사전조건** | 로그아웃 상태 |

### 테스트 단계

1. "GitHub로 로그인" 클릭
2. GitHub 인증 페이지에서 "Cancel" 클릭

### 예상 결과

- [ ] 로그인 페이지로 리다이렉트
- [ ] 적절한 에러 메시지 표시 (또는 무시)
- [ ] 계정 생성되지 않음

---

## TC-012: OAuth Provider 서버 오류

| 항목 | 내용 |
|------|------|
| **ID** | TC-012 |
| **우선순위** | Medium |
| **사전조건** | - |

### 테스트 단계

1. GitHub/Google API가 오류 응답을 반환하는 상황 시뮬레이션
2. OAuth 콜백 처리 확인

### 예상 결과

- [ ] 500 에러 발생하지 않음
- [ ] 사용자에게 친화적인 에러 메시지 표시
- [ ] 로그인 페이지로 리다이렉트
- [ ] Sentry에 에러 로깅됨

---

## TC-013: 중복 소셜 계정 연동 시도

| 항목 | 내용 |
|------|------|
| **ID** | TC-013 |
| **우선순위** | Medium |
| **사전조건** | 다른 사용자가 이미 해당 GitHub 계정을 연동함 |

### 테스트 단계

1. 로그인 상태에서 설정 페이지 접속
2. 이미 다른 계정에 연동된 GitHub 계정으로 연동 시도

### 예상 결과

- [ ] 연동 실패
- [ ] "이미 다른 계정에 연동된 소셜 계정입니다" 에러 메시지
- [ ] 기존 연동 상태 변경 없음

---

## TC-014: 미인증 상태에서 소셜 계정 API 접근

| 항목 | 내용 |
|------|------|
| **ID** | TC-014 |
| **우선순위** | High |
| **사전조건** | 로그아웃 상태 |

### 테스트 단계

1. 직접 API 호출: `GET /api/auth/social-accounts`
2. 직접 API 호출: `DELETE /api/auth/social-accounts/github`

### 예상 결과

- [ ] 401 Unauthorized 응답
- [ ] 소셜 계정 정보 노출되지 않음

---

## TC-015: 토큰 암호화 검증

| 항목 | 내용 |
|------|------|
| **ID** | TC-015 |
| **우선순위** | Critical |
| **사전조건** | 소셜 계정 연동 완료 |

### 테스트 단계

1. 데이터베이스 직접 조회
2. `social_accounts.access_token` 값 확인

### 예상 결과

- [ ] 토큰이 평문으로 저장되지 않음
- [ ] Laravel Crypt로 암호화된 형태로 저장됨
- [ ] 애플리케이션에서 복호화하여 정상 사용 가능

---

## TC-016: 소셜 계정 Soft Delete 검증

| 항목 | 내용 |
|------|------|
| **ID** | TC-016 |
| **우선순위** | Medium |
| **사전조건** | 소셜 계정 연동 해제 완료 |

### 테스트 단계

1. 데이터베이스 직접 조회
2. `social_accounts` 테이블 확인

### 예상 결과

- [ ] 레코드가 물리적으로 삭제되지 않음
- [ ] `deleted_at` 컬럼에 타임스탬프 설정됨
- [ ] 애플리케이션에서 조회 시 해당 레코드 제외됨

---

## TC-017: 동일 Provider 재연동

| 항목 | 내용 |
|------|------|
| **ID** | TC-017 |
| **우선순위** | Medium |
| **사전조건** | GitHub 연동 해제 후 |

### 테스트 단계

1. 설정 페이지에서 GitHub "연동하기" 클릭
2. 동일한 GitHub 계정으로 재연동

### 예상 결과

- [ ] 재연동 성공
- [ ] 새 `social_accounts` 레코드 생성 (또는 soft delete 복구)
- [ ] 정상 작동

---

## TC-018: 모바일 브라우저 OAuth 플로우

| 항목 | 내용 |
|------|------|
| **ID** | TC-018 |
| **우선순위** | Medium |
| **사전조건** | 모바일 기기 또는 시뮬레이터 |

### 테스트 단계

1. 모바일 브라우저에서 로그인 페이지 접속
2. "GitHub로 로그인" 클릭
3. OAuth 인증 완료

### 예상 결과

- [ ] 모바일에서 OAuth 플로우 정상 작동
- [ ] 리다이렉트 정상 처리
- [ ] 로그인 완료

---

## 테스트 결과 요약

| TC ID | 테스트명 | 결과 | 테스터 | 날짜 |
|-------|---------|------|--------|------|
| TC-001 | GitHub OAuth 신규 회원가입 | ⬜ | | |
| TC-002 | GitHub OAuth 기존 회원 로그인 | ⬜ | | |
| TC-003 | GitHub OAuth 이메일 매칭 연동 | ⬜ | | |
| TC-004 | Google OAuth 신규 회원가입 | ⬜ | | |
| TC-005 | Google OAuth 기존 회원 로그인 | ⬜ | | |
| TC-006 | 설정 페이지 소셜 계정 목록 조회 | ⬜ | | |
| TC-007 | 설정 페이지에서 소셜 계정 추가 연동 | ⬜ | | |
| TC-008 | 소셜 계정 연동 해제 (비밀번호 있음) | ⬜ | | |
| TC-009 | 소셜 계정 연동 해제 (복수 소셜 계정) | ⬜ | | |
| TC-010 | 마지막 인증 수단 연동 해제 차단 | ⬜ | | |
| TC-011 | OAuth 인증 취소 | ⬜ | | |
| TC-012 | OAuth Provider 서버 오류 | ⬜ | | |
| TC-013 | 중복 소셜 계정 연동 시도 | ⬜ | | |
| TC-014 | 미인증 상태에서 소셜 계정 API 접근 | ⬜ | | |
| TC-015 | 토큰 암호화 검증 | ⬜ | | |
| TC-016 | 소셜 계정 Soft Delete 검증 | ⬜ | | |
| TC-017 | 동일 Provider 재연동 | ⬜ | | |
| TC-018 | 모바일 브라우저 OAuth 플로우 | ⬜ | | |

**범례**: ✅ Pass | ❌ Fail | ⬜ Not Tested | 🔄 In Progress
